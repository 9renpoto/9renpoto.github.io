{"data":{"title":"入門chef","date":"2013-12-22T00:00:00.000Z","permalink":"/entry/2013/12/22/my-first-chef/","categories":["ruby","chef"],"_entry":"posts/2013-12-22-my-first-chef/index.md","page":"post","name":"index","category":"2013-12-22-my-first-chef","url":"/entry/2013/12/22/my-first-chef/"},"content":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"chef memo","position":{"start":{"line":1,"column":3,"offset":2},"end":{"line":1,"column":12,"offset":11}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":12,"offset":11}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"環境構築といえば、chefだという噂を随分と聞くようになってきましたが、\nなんだかんだと使ってなかったのでメモ。\nとはいえ、レシピは誰かが書いてるので、\n今回は出来る限りレシピを使う方法で構築を目指す。","position":{"start":{"line":3,"column":1,"offset":13},"end":{"line":6,"column":25,"offset":114}}}],"position":{"start":{"line":3,"column":1,"offset":13},"end":{"line":6,"column":25,"offset":114}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"前準備","position":{"start":{"line":8,"column":4,"offset":119},"end":{"line":8,"column":7,"offset":122}}}],"position":{"start":{"line":8,"column":1,"offset":116},"end":{"line":8,"column":7,"offset":122}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ruby"]},"children":[{"type":"text","value":"# Gemfileに記載\nsource 'https://rubygems。org'  # URLの指定。呪文だと思って毎回書く\n\ngem 'berkshelf'\ngem 'chef'\ngem 'knife-solo'\n"}],"position":{"start":{"line":10,"column":1,"offset":124},"end":{"line":17,"column":4,"offset":245}}}],"position":{"start":{"line":10,"column":1,"offset":124},"end":{"line":17,"column":4,"offset":245}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"必要なgemをいつものように。","position":{"start":{"line":19,"column":1,"offset":247},"end":{"line":19,"column":16,"offset":262}}}],"position":{"start":{"line":19,"column":1,"offset":247},"end":{"line":19,"column":16,"offset":262}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle install\n"}],"position":{"start":{"line":21,"column":1,"offset":264},"end":{"line":23,"column":4,"offset":288}}}],"position":{"start":{"line":21,"column":1,"offset":264},"end":{"line":23,"column":4,"offset":288}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"chef-soloを使えるように初期設定を行う。","position":{"start":{"line":25,"column":1,"offset":290},"end":{"line":25,"column":25,"offset":314}}}],"position":{"start":{"line":25,"column":1,"offset":290},"end":{"line":25,"column":25,"offset":314}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle exec knife configure\n"}],"position":{"start":{"line":27,"column":1,"offset":316},"end":{"line":29,"column":4,"offset":353}}}],"position":{"start":{"line":27,"column":1,"offset":316},"end":{"line":29,"column":4,"offset":353}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"そろそろchef","position":{"start":{"line":31,"column":4,"offset":358},"end":{"line":31,"column":12,"offset":366}}}],"position":{"start":{"line":31,"column":1,"offset":355},"end":{"line":31,"column":12,"offset":366}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ひな形の生成。","position":{"start":{"line":33,"column":1,"offset":368},"end":{"line":33,"column":8,"offset":375}}}],"position":{"start":{"line":33,"column":1,"offset":368},"end":{"line":33,"column":8,"offset":375}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"$ bundle exec knife solo init chef-repo\n$ tree chef-repo/\nchef-repo/\n├── cookbooks\n├── data_bags\n├── nodes\n├── roles\n├── site-cookbooks\n└── solo。rb\n"}],"position":{"start":{"line":35,"column":1,"offset":377},"end":{"line":45,"column":4,"offset":536}}}],"position":{"start":{"line":35,"column":1,"offset":377},"end":{"line":45,"column":4,"offset":536}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"忘れないうちにコミット。","position":{"start":{"line":47,"column":1,"offset":538},"end":{"line":47,"column":13,"offset":550}}}],"position":{"start":{"line":47,"column":1,"offset":538},"end":{"line":47,"column":13,"offset":550}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"cd chef-repo\ngit init\ngit add 。\ngit commit -m 'first commit'\n"}],"position":{"start":{"line":49,"column":1,"offset":552},"end":{"line":54,"column":4,"offset":622}}}],"position":{"start":{"line":49,"column":1,"offset":552},"end":{"line":54,"column":4,"offset":622}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"公式なり、Githubにて公開されているレシピを利用しやすくるものとして ","position":{"start":{"line":56,"column":1,"offset":624},"end":{"line":56,"column":38,"offset":661}}},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Berksfile","position":{"start":{"line":56,"column":40,"offset":663},"end":{"line":56,"column":49,"offset":672}}}],"position":{"start":{"line":56,"column":38,"offset":661},"end":{"line":56,"column":51,"offset":674}}},{"type":"text","value":" があります。","position":{"start":{"line":56,"column":51,"offset":674},"end":{"line":56,"column":58,"offset":681}}}],"position":{"start":{"line":56,"column":1,"offset":624},"end":{"line":56,"column":58,"offset":681}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ruby"]},"children":[{"type":"text","value":"site :opscode # Berksfile\n\ncookbook \"apt\"\ncookbook \"git\"\ncookbook \"zsh\"\ncookbook 'vim'\ncookbook 'the_silver_searcher'\n"}],"position":{"start":{"line":58,"column":1,"offset":683},"end":{"line":66,"column":4,"offset":812}}}],"position":{"start":{"line":58,"column":1,"offset":683},"end":{"line":66,"column":4,"offset":812}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"公開されているレシピの情報を記述しておけば、コマンド1つで落としてこれます。\n便利。","position":{"start":{"line":68,"column":1,"offset":814},"end":{"line":69,"column":4,"offset":856}}}],"position":{"start":{"line":68,"column":1,"offset":814},"end":{"line":69,"column":4,"offset":856}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle exec berks install --permalink cookbooks\n"}],"position":{"start":{"line":71,"column":1,"offset":858},"end":{"line":73,"column":4,"offset":915}}}],"position":{"start":{"line":71,"column":1,"offset":858},"end":{"line":73,"column":4,"offset":915}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"vagrant側でchefが使えるように以下のコマンドを実行。","position":{"start":{"line":75,"column":1,"offset":917},"end":{"line":75,"column":32,"offset":948}}}],"position":{"start":{"line":75,"column":1,"offset":917},"end":{"line":75,"column":32,"offset":948}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle exec knife solo prepare nodename\n"}],"position":{"start":{"line":77,"column":1,"offset":950},"end":{"line":79,"column":4,"offset":999}}}],"position":{"start":{"line":77,"column":1,"offset":950},"end":{"line":79,"column":4,"offset":999}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"インストールしたいレシピを追加\nnode/nodename.json。","position":{"start":{"line":81,"column":1,"offset":1001},"end":{"line":82,"column":20,"offset":1036}}}],"position":{"start":{"line":81,"column":1,"offset":1001},"end":{"line":82,"column":20,"offset":1036}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"{\n  \"run_list\": [\n    \"recipe[apt]\",\n    \"recipe[git]\",\n    \"recipe[zsh]\",\n    \"recipe[vim]\",\n    \"recipe[the_silver_searcher]\"\n  ]\n}\n"}],"position":{"start":{"line":84,"column":1,"offset":1038},"end":{"line":94,"column":4,"offset":1181}}}],"position":{"start":{"line":84,"column":1,"offset":1038},"end":{"line":94,"column":4,"offset":1181}}},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"レシピはできたのでcookしましょう。","position":{"start":{"line":96,"column":1,"offset":1183},"end":{"line":96,"column":20,"offset":1202}}}],"position":{"start":{"line":96,"column":1,"offset":1183},"end":{"line":96,"column":20,"offset":1202}}},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle exec knife solo cook nodename\n"}],"position":{"start":{"line":98,"column":1,"offset":1204},"end":{"line":100,"column":4,"offset":1250}}}],"position":{"start":{"line":98,"column":1,"offset":1204},"end":{"line":100,"column":4,"offset":1250}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"参考","position":{"start":{"line":102,"column":4,"offset":1255},"end":{"line":102,"column":6,"offset":1257}}}],"position":{"start":{"line":102,"column":1,"offset":1252},"end":{"line":102,"column":6,"offset":1257}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://qiita.com/uchiunyo/items/5aa243f7a39ae443e10d"},"children":[{"type":"text","value":"qiita.com/uchiunyo/item","position":{"start":{"line":104,"column":4,"offset":1262},"end":{"line":104,"column":27,"offset":1285}}}],"position":{"start":{"line":104,"column":3,"offset":1261},"end":{"line":104,"column":83,"offset":1341}}}],"position":{"start":{"line":104,"column":1,"offset":1259},"end":{"line":104,"column":83,"offset":1341}}},{"type":"text","value":"\n"}],"position":{"start":{"line":104,"column":1,"offset":1259},"end":{"line":104,"column":83,"offset":1341}}}],"data":{"quirksMode":false},"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":1,"offset":0}}},"raw":"# chef memo\n\n環境構築といえば、chefだという噂を随分と聞くようになってきましたが、\nなんだかんだと使ってなかったのでメモ。\nとはいえ、レシピは誰かが書いてるので、\n今回は出来る限りレシピを使う方法で構築を目指す。\n\n## 前準備\n\n```ruby\n# Gemfileに記載\nsource 'https://rubygems。org'  # URLの指定。呪文だと思って毎回書く\n\ngem 'berkshelf'\ngem 'chef'\ngem 'knife-solo'\n```\n\n必要なgemをいつものように。\n\n```sh\nbundle install\n```\n\nchef-soloを使えるように初期設定を行う。\n\n```sh\nbundle exec knife configure\n```\n\n## そろそろchef\n\nひな形の生成。\n\n```bash\n$ bundle exec knife solo init chef-repo\n$ tree chef-repo/\nchef-repo/\n├── cookbooks\n├── data_bags\n├── nodes\n├── roles\n├── site-cookbooks\n└── solo。rb\n```\n\n忘れないうちにコミット。\n\n```sh\ncd chef-repo\ngit init\ngit add 。\ngit commit -m 'first commit'\n```\n\n公式なり、Githubにて公開されているレシピを利用しやすくるものとして **Berksfile** があります。\n\n```ruby\nsite :opscode # Berksfile\n\ncookbook \"apt\"\ncookbook \"git\"\ncookbook \"zsh\"\ncookbook 'vim'\ncookbook 'the_silver_searcher'\n```\n\n公開されているレシピの情報を記述しておけば、コマンド1つで落としてこれます。\n便利。\n\n```sh\nbundle exec berks install --permalink cookbooks\n```\n\nvagrant側でchefが使えるように以下のコマンドを実行。\n\n```sh\nbundle exec knife solo prepare nodename\n```\n\nインストールしたいレシピを追加\nnode/nodename.json。\n\n```js\n{\n  \"run_list\": [\n    \"recipe[apt]\",\n    \"recipe[git]\",\n    \"recipe[zsh]\",\n    \"recipe[vim]\",\n    \"recipe[the_silver_searcher]\"\n  ]\n}\n```\n\nレシピはできたのでcookしましょう。\n\n```sh\nbundle exec knife solo cook nodename\n```\n\n## 参考\n\n- [qiita.com/uchiunyo/item](https://qiita.com/uchiunyo/items/5aa243f7a39ae443e10d)\n"}