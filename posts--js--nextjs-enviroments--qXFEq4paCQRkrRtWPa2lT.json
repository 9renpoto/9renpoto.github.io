{"data":{"date":"2018-12-13T09:00:00.000Z","permalink":"/entry/2018/12/13/nextjs-enviroments/","title":"next.js で `process.env` 以下の環境変数を参照する","category":"react","_entry":"posts/js/nextjs-enviroments.md","page":"post","name":"nextjs-enviroments","url":"/entry/2018/12/13/nextjs-enviroments/"},"content":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"TL;DR","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":8,"offset":8}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":8,"offset":8}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"next/config"}],"position":{"start":{"line":4,"column":3,"offset":12},"end":{"line":4,"column":16,"offset":25}}},{"type":"text","value":" をとりあえず使う","position":{"start":{"line":4,"column":16,"offset":25},"end":{"line":4,"column":25,"offset":34}}}],"position":{"start":{"line":4,"column":1,"offset":10},"end":{"line":4,"column":25,"offset":34}}},{"type":"text","value":"\n"}],"position":{"start":{"line":4,"column":1,"offset":10},"end":{"line":4,"column":25,"offset":34}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"webpack.DefinePlugin"}],"position":{"start":{"line":6,"column":4,"offset":39},"end":{"line":6,"column":26,"offset":61}}},{"type":"text","value":" を使う","position":{"start":{"line":6,"column":26,"offset":61},"end":{"line":6,"column":30,"offset":65}}}],"position":{"start":{"line":6,"column":1,"offset":36},"end":{"line":6,"column":30,"offset":65}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"refs: ","position":{"start":{"line":8,"column":3,"offset":69},"end":{"line":8,"column":9,"offset":75}}},{"type":"element","tagName":"a","properties":{"href":"https://github.com/zeit/next.js/issues/3605"},"children":[{"type":"text","value":"https://github.com/zeit/next.js/issues/3605","position":{"start":{"line":8,"column":10,"offset":76},"end":{"line":8,"column":53,"offset":119}}}],"position":{"start":{"line":8,"column":9,"offset":75},"end":{"line":8,"column":54,"offset":120}}}],"position":{"start":{"line":8,"column":1,"offset":67},"end":{"line":8,"column":54,"offset":120}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"なれてるし使いたい。わかる","position":{"start":{"line":9,"column":3,"offset":123},"end":{"line":9,"column":16,"offset":136}}}],"position":{"start":{"line":9,"column":1,"offset":121},"end":{"line":9,"column":16,"offset":136}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"イマイチ推奨されてないようで、 ","position":{"start":{"line":10,"column":3,"offset":139},"end":{"line":10,"column":19,"offset":155}}},{"type":"element","tagName":"a","properties":{"href":"https://github.com/zeit/next.js/issues/3605#issuecomment-359512586"},"children":[{"type":"text","value":"複数のサンプルが紹介されている","position":{"start":{"line":10,"column":20,"offset":156},"end":{"line":10,"column":35,"offset":171}}}],"position":{"start":{"line":10,"column":19,"offset":155},"end":{"line":10,"column":104,"offset":240}}}],"position":{"start":{"line":10,"column":1,"offset":137},"end":{"line":10,"column":104,"offset":240}}},{"type":"text","value":"\n"}],"position":{"start":{"line":8,"column":1,"offset":67},"end":{"line":10,"column":104,"offset":240}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"babel-plugin-transform-define"}],"position":{"start":{"line":12,"column":4,"offset":245},"end":{"line":12,"column":35,"offset":276}}},{"type":"text","value":" を使う","position":{"start":{"line":12,"column":35,"offset":276},"end":{"line":12,"column":39,"offset":280}}}],"position":{"start":{"line":12,"column":1,"offset":242},"end":{"line":12,"column":39,"offset":280}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"refs: ","position":{"start":{"line":14,"column":3,"offset":284},"end":{"line":14,"column":9,"offset":290}}},{"type":"element","tagName":"a","properties":{"href":"https://github.com/zeit/next.js/tree/master/examples/with-universal-configuration-build-time"},"children":[{"type":"text","value":"https://github.com/zeit/next.js/tree/master/examples/with-universal-configuration-build-time","position":{"start":{"line":14,"column":10,"offset":291},"end":{"line":14,"column":102,"offset":383}}}],"position":{"start":{"line":14,"column":9,"offset":290},"end":{"line":14,"column":103,"offset":384}}}],"position":{"start":{"line":14,"column":1,"offset":282},"end":{"line":14,"column":103,"offset":384}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"babel7に対応してない（2018/12現在）。","position":{"start":{"line":15,"column":3,"offset":387},"end":{"line":15,"column":28,"offset":412}}},{"type":"element","tagName":"a","properties":{"href":"https://github.com/FormidableLabs/babel-plugin-transform-define/pull/49"},"children":[{"type":"text","value":"PR はあるけれど放置されている","position":{"start":{"line":15,"column":29,"offset":413},"end":{"line":15,"column":45,"offset":429}}}],"position":{"start":{"line":15,"column":28,"offset":412},"end":{"line":15,"column":119,"offset":503}}}],"position":{"start":{"line":15,"column":1,"offset":385},"end":{"line":15,"column":119,"offset":503}}},{"type":"text","value":"\n"}],"position":{"start":{"line":14,"column":1,"offset":282},"end":{"line":15,"column":119,"offset":503}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dotenv-webpack"}],"position":{"start":{"line":17,"column":4,"offset":508},"end":{"line":17,"column":20,"offset":524}}},{"type":"text","value":" を使う","position":{"start":{"line":17,"column":20,"offset":524},"end":{"line":17,"column":24,"offset":528}}}],"position":{"start":{"line":17,"column":1,"offset":505},"end":{"line":17,"column":24,"offset":528}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"refs: ","position":{"start":{"line":19,"column":3,"offset":532},"end":{"line":19,"column":9,"offset":538}}},{"type":"element","tagName":"a","properties":{"href":"https://github.com/zeit/next.js/tree/canary/examples/with-dotenv"},"children":[{"type":"text","value":"https://github.com/zeit/next.js/tree/canary/examples/with-dotenv","position":{"start":{"line":19,"column":10,"offset":539},"end":{"line":19,"column":74,"offset":603}}}],"position":{"start":{"line":19,"column":9,"offset":538},"end":{"line":19,"column":75,"offset":604}}}],"position":{"start":{"line":19,"column":1,"offset":530},"end":{"line":19,"column":75,"offset":604}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"dockerの下りで ","position":{"start":{"line":20,"column":3,"offset":607},"end":{"line":20,"column":14,"offset":618}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".envrc"}],"position":{"start":{"line":20,"column":14,"offset":618},"end":{"line":20,"column":22,"offset":626}}},{"type":"text","value":" ではなく ","position":{"start":{"line":20,"column":22,"offset":626},"end":{"line":20,"column":28,"offset":632}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":".env"}],"position":{"start":{"line":20,"column":28,"offset":632},"end":{"line":20,"column":34,"offset":638}}},{"type":"text","value":" を利用するプロダクトが増えた","position":{"start":{"line":20,"column":34,"offset":638},"end":{"line":20,"column":49,"offset":653}}}],"position":{"start":{"line":20,"column":1,"offset":605},"end":{"line":20,"column":49,"offset":653}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"よしなに展開してくれる","position":{"start":{"line":21,"column":3,"offset":656},"end":{"line":21,"column":14,"offset":667}}}],"position":{"start":{"line":21,"column":1,"offset":654},"end":{"line":21,"column":14,"offset":667}}},{"type":"text","value":"\n"}],"position":{"start":{"line":19,"column":1,"offset":530},"end":{"line":21,"column":14,"offset":667}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"標準で用意されている仕組みを使う","position":{"start":{"line":23,"column":4,"offset":672},"end":{"line":23,"column":20,"offset":688}}}],"position":{"start":{"line":23,"column":1,"offset":669},"end":{"line":23,"column":20,"offset":688}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"refs","position":{"start":{"line":25,"column":3,"offset":692},"end":{"line":25,"column":7,"offset":696}}},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://spectrum.chat/next-js/general/runtime-configs-with-process-env~55b503c2-07f4-4da3-9ba4-287733b3d622"},"children":[{"type":"text","value":"https://spectrum.chat/next-js/general/runtime-configs-with-process-env~55b503c2-07f4-4da3-9ba4-287733b3d622","position":{"start":{"line":26,"column":6,"offset":702},"end":{"line":26,"column":113,"offset":809}}}],"position":{"start":{"line":26,"column":5,"offset":701},"end":{"line":26,"column":114,"offset":810}}}],"position":{"start":{"line":26,"column":3,"offset":699},"end":{"line":26,"column":114,"offset":810}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/zeit/next.js#exposing-configuration-to-the-server--client-side"},"children":[{"type":"text","value":"https://github.com/zeit/next.js#exposing-configuration-to-the-server--client-side","position":{"start":{"line":27,"column":6,"offset":816},"end":{"line":27,"column":87,"offset":897}}}],"position":{"start":{"line":27,"column":5,"offset":815},"end":{"line":27,"column":88,"offset":898}}}],"position":{"start":{"line":27,"column":3,"offset":813},"end":{"line":27,"column":88,"offset":898}}},{"type":"text","value":"\n"}],"position":{"start":{"line":26,"column":3,"offset":699},"end":{"line":27,"column":88,"offset":898}}}],"position":{"start":{"line":25,"column":1,"offset":690},"end":{"line":27,"column":88,"offset":898}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"clientでは配信したくない環境変数とか確かにある","position":{"start":{"line":28,"column":3,"offset":901},"end":{"line":28,"column":29,"offset":927}}}],"position":{"start":{"line":28,"column":1,"offset":899},"end":{"line":28,"column":29,"offset":927}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"面倒だけれど別々に宣言的管理する","position":{"start":{"line":29,"column":3,"offset":930},"end":{"line":29,"column":19,"offset":946}}}],"position":{"start":{"line":29,"column":1,"offset":928},"end":{"line":29,"column":19,"offset":946}}},{"type":"text","value":"\n"}],"position":{"start":{"line":25,"column":1,"offset":690},"end":{"line":29,"column":19,"offset":946}}}],"data":{"quirksMode":false},"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":1,"offset":0}}},"raw":"\n# TL;DR\n\n- `next/config` をとりあえず使う\n\n## `webpack.DefinePlugin` を使う\n\n- refs: <https://github.com/zeit/next.js/issues/3605>\n- なれてるし使いたい。わかる\n- イマイチ推奨されてないようで、 [複数のサンプルが紹介されている](https://github.com/zeit/next.js/issues/3605#issuecomment-359512586)\n\n## `babel-plugin-transform-define` を使う\n\n- refs: <https://github.com/zeit/next.js/tree/master/examples/with-universal-configuration-build-time>\n- babel7に対応してない（2018/12現在）。[PR はあるけれど放置されている](https://github.com/FormidableLabs/babel-plugin-transform-define/pull/49)\n\n## `dotenv-webpack` を使う\n\n- refs: <https://github.com/zeit/next.js/tree/canary/examples/with-dotenv>\n- dockerの下りで `.envrc` ではなく `.env` を利用するプロダクトが増えた\n- よしなに展開してくれる\n\n## 標準で用意されている仕組みを使う\n\n- refs\n  - <https://spectrum.chat/next-js/general/runtime-configs-with-process-env~55b503c2-07f4-4da3-9ba4-287733b3d622>\n  - <https://github.com/zeit/next.js#exposing-configuration-to-the-server--client-side>\n- clientでは配信したくない環境変数とか確かにある\n- 面倒だけれど別々に宣言的管理する\n"}