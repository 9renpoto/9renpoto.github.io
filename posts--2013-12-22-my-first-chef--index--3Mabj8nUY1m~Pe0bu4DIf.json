{"data":{"title":"入門chef","date":"2013-12-22T00:00:00.000Z","permalink":"/entry/2013/12/22/my-first-chef/","categories":["ruby","chef"],"_entry":"posts/2013-12-22-my-first-chef/index.md","page":"post","name":"index","category":"2013-12-22-my-first-chef","url":"/entry/2013/12/22/my-first-chef/"},"content":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"chef memo"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"環境構築といえば、chefだという噂を随分と聞くようになってきましたが、\nなんだかんだと使ってなかったのでメモ。\nとはいえ、レシピは誰かが書いてるので、\n今回は出来る限りレシピを使う方法で構築を目指す。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"前準備"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ruby"]},"children":[{"type":"text","value":"# Gemfileに記載\nsource 'https://rubygems。org'  # URLの指定。呪文だと思って毎回書く\n\ngem 'berkshelf'\ngem 'chef'\ngem 'knife-solo'\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"必要なgemをいつものように。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle install\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"chef-soloを使えるように初期設定を行う。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle exec knife configure\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"そろそろchef"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ひな形の生成。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"$ bundle exec knife solo init chef-repo\n$ tree chef-repo/\nchef-repo/\n├── cookbooks\n├── data_bags\n├── nodes\n├── roles\n├── site-cookbooks\n└── solo。rb\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"忘れないうちにコミット。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"cd chef-repo\ngit init\ngit add 。\ngit commit -m 'first commit'\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"公式なり、Githubにて公開されているレシピを利用しやすくるものとして "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Berksfile"}]},{"type":"text","value":" があります。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ruby"]},"children":[{"type":"text","value":"site :opscode # Berksfile\n\ncookbook \"apt\"\ncookbook \"git\"\ncookbook \"zsh\"\ncookbook 'vim'\ncookbook 'the_silver_searcher'\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"公開されているレシピの情報を記述しておけば、コマンド1つで落としてこれます。\n便利。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle exec berks install --permalink cookbooks\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"vagrant側でchefが使えるように以下のコマンドを実行。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle exec knife solo prepare nodename\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"インストールしたいレシピを追加\nnode/nodename.json。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"{\n  \"run_list\": [\n    \"recipe[apt]\",\n    \"recipe[git]\",\n    \"recipe[zsh]\",\n    \"recipe[vim]\",\n    \"recipe[the_silver_searcher]\"\n  ]\n}\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"レシピはできたのでcookしましょう。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-sh"]},"children":[{"type":"text","value":"bundle exec knife solo cook nodename\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"参考"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://qiita.com/uchiunyo/items/5aa243f7a39ae443e10d"},"children":[{"type":"text","value":"qiita.com/uchiunyo/item"}]}]},{"type":"text","value":"\n"}]}],"data":{"quirksMode":false}},"raw":"# chef memo\n\n環境構築といえば、chefだという噂を随分と聞くようになってきましたが、\nなんだかんだと使ってなかったのでメモ。\nとはいえ、レシピは誰かが書いてるので、\n今回は出来る限りレシピを使う方法で構築を目指す。\n\n## 前準備\n\n```ruby\n# Gemfileに記載\nsource 'https://rubygems。org'  # URLの指定。呪文だと思って毎回書く\n\ngem 'berkshelf'\ngem 'chef'\ngem 'knife-solo'\n```\n\n必要なgemをいつものように。\n\n```sh\nbundle install\n```\n\nchef-soloを使えるように初期設定を行う。\n\n```sh\nbundle exec knife configure\n```\n\n## そろそろchef\n\nひな形の生成。\n\n```bash\n$ bundle exec knife solo init chef-repo\n$ tree chef-repo/\nchef-repo/\n├── cookbooks\n├── data_bags\n├── nodes\n├── roles\n├── site-cookbooks\n└── solo。rb\n```\n\n忘れないうちにコミット。\n\n```sh\ncd chef-repo\ngit init\ngit add 。\ngit commit -m 'first commit'\n```\n\n公式なり、Githubにて公開されているレシピを利用しやすくるものとして **Berksfile** があります。\n\n```ruby\nsite :opscode # Berksfile\n\ncookbook \"apt\"\ncookbook \"git\"\ncookbook \"zsh\"\ncookbook 'vim'\ncookbook 'the_silver_searcher'\n```\n\n公開されているレシピの情報を記述しておけば、コマンド1つで落としてこれます。\n便利。\n\n```sh\nbundle exec berks install --permalink cookbooks\n```\n\nvagrant側でchefが使えるように以下のコマンドを実行。\n\n```sh\nbundle exec knife solo prepare nodename\n```\n\nインストールしたいレシピを追加\nnode/nodename.json。\n\n```js\n{\n  \"run_list\": [\n    \"recipe[apt]\",\n    \"recipe[git]\",\n    \"recipe[zsh]\",\n    \"recipe[vim]\",\n    \"recipe[the_silver_searcher]\"\n  ]\n}\n```\n\nレシピはできたのでcookしましょう。\n\n```sh\nbundle exec knife solo cook nodename\n```\n\n## 参考\n\n- [qiita.com/uchiunyo/item](https://qiita.com/uchiunyo/items/5aa243f7a39ae443e10d)\n"}