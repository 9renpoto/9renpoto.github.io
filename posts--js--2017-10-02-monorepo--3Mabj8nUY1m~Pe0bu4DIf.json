{"data":{"title":"複数環境構築のためにLernaを使う、が","date":"2017-10-02T02:00:00.000Z","permalink":"/entry/2017/10/02/monorepo/","category":"js","_entry":"posts/js/2017-10-02-monorepo.md","page":"post","name":"monorepo","url":"/entry/2017/10/02/monorepo/"},"content":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"TL;DR"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"期待通りに動かない"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"npm or yarn"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"npmClientを指定できるようだが、yarnを指定すると永遠にインストールが終わらない問題に出くわす"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://travis-ci.org/9renpoto/eslint-config/builds/281805776"},"children":[{"type":"text","value":"https://travis-ci.org/9renpoto/eslint-config/builds/281805776"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"concurrency=1"}]},{"type":"text","value":" を指定するなど試すもretryしてやっと動く程度"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"期待するportに接続できていない？"}]},{"type":"text","value":"\n"}]}]},{"type":"text","value":"\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"npm v5"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"何故かlernaを通してやると "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"dependencies"}]},{"type":"text","value":" がrootに展開されず見つからない場合がある"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"ディレクトリ直下でやると問題ない場合がある"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"バグっている気持ち"}]},{"type":"text","value":"\n"}]}]},{"type":"text","value":"\n"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"lerna bootstrap"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"共通packageとは、本当はディレクトリ直下で行いたいができていないようにみえる"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"lerna version 2.2.0"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"結局複数installを求められるものがある？"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"eslint"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"typescript"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"flow-bin"}]},{"type":"text","value":"\n"}]}]},{"type":"text","value":"\n"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"まとめ"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"原因は調べきれていないが、lernaが原因で使えていない問題はいろいろありそう"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"issueは200以上ある"}]},{"type":"text","value":"\n"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"早めに地雷を踏んでおく"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"http://3.bp.blogspot.com/-R1W3888HcbU/V9ppr9A_NHI/AAAAAAAA9wE/CuzJ-JfOQz8Ht6w-jNN79_vh6-TeVOGNACLcB/s800/jirai_tanchiki_man.png","alt":"image"},"children":[]}]}],"data":{"quirksMode":false}},"raw":"\n# TL;DR\n\n- 期待通りに動かない\n\n## npm or yarn\n\n- npmClientを指定できるようだが、yarnを指定すると永遠にインストールが終わらない問題に出くわす\n  - <https://travis-ci.org/9renpoto/eslint-config/builds/281805776>\n  - `concurrency=1` を指定するなど試すもretryしてやっと動く程度\n    - 期待するportに接続できていない？\n- npm v5\n  - 何故かlernaを通してやると `dependencies` がrootに展開されず見つからない場合がある\n  - ディレクトリ直下でやると問題ない場合がある\n    - バグっている気持ち\n\n## lerna bootstrap\n\n- 共通packageとは、本当はディレクトリ直下で行いたいができていないようにみえる\n  - lerna version 2.2.0\n  - 結局複数installを求められるものがある？\n    - eslint\n    - typescript\n    - flow-bin\n\n## まとめ\n\n- 原因は調べきれていないが、lernaが原因で使えていない問題はいろいろありそう\n  - issueは200以上ある\n- 早めに地雷を踏んでおく\n\n![image](http://3.bp.blogspot.com/-R1W3888HcbU/V9ppr9A_NHI/AAAAAAAA9wE/CuzJ-JfOQz8Ht6w-jNN79_vh6-TeVOGNACLcB/s800/jirai_tanchiki_man.png)\n"}