<!DOCTYPE html><html><head><meta charSet="utf-8" class="next-head"/><title class="next-head">:-) Frontend JavaScript Anti-pattern</title><link rel="stylesheet" href="/static/bundle.css" class="next-head"/><link rel="preload" href="/_next/6f6265f8-680a-44ae-af1a-c769f88afddc/page/post.js" as="script"/><link rel="preload" href="/_next/6f6265f8-680a-44ae-af1a-c769f88afddc/page/_error.js" as="script"/><link rel="preload" href="/_next/39a698509300633fdb6653901559ccd2/app.js" as="script"/></head><body><div><div id="__next"><div data-reactroot=""><div><header class="navbar"><div class="navbar-brand"><a class="navbar-item" href="/">:-)</a><div class="navbar-burger burger" data-target="navMenu"><span></span><span></span><span></span></div></div><div class="navbar-menu" id="navMenu"><div class="navbar-end"><a class="navbar-item" href="https://9renpoto.github.io/entry/tags/">tags</a><a class="navbar-item" href="https://9renpoto.github.io/entry/profile/">profile</a></div></div></header><section class="hero is-primary"><div class="hero-body"><div class="container"><h1 class="title">Frontend JavaScript Anti-pattern</h1></div></div></section><section class="section"><div class="container is-fluid"><div class="content"><div><h1>TL;DR</h1>
<ul>
<li>自分のエゴで書いてる手癖や無駄な努力をコードレビューするのは非生産的</li>
<li>積極的にlinterを採用</li>
</ul>
<h2>test</h2>
<pre><code class="language-js">import assert from &#x27;assert&#x27;

describe(&#x27;test&#x27;, () =&gt; {
  const { func } = require(&#x27;./module&#x27;)
  it(&#x27;func&#x27;, () =&gt; {
    assert(func(&#x27;a&#x27;) === &#x27;a&#x27;)
  })
})
</code></pre>
<ol>
<li>
<p>1ファイル、single <code>describe</code></p>
<ol>
<li>親を1つ <code>describe.skip</code> <code>describe.only</code> できれば一旦闇を保留にできることが多い</li>
<li>1ファイルの持っている役割が大きすぎない、特に困っていない</li>
</ol>
</li>
<li>
<p>テスト対象は <code>describe</code> の中でrequireする</p>
<ol>
<li><code>describe.only</code> 実行をした際に不要なsrcを読み込まなくて良い</li>
<li>読み込まれただけで実行される関数はcoverageに含まれてしまう</li>
<li><code>coverage report</code> が読みやすい</li>
</ol>
</li>
<li>
<p><code>this</code> を使わない</p>
<ol>
<li>unused変数をlintで発見しやすい</li>
<li>長い</li>
</ol>
</li>
</ol>
<h2>src</h2>
<pre><code class="language-js">function mapStateToProps ({ todos }: State) {
  return {
    tasks: { todos },
    onUpdate: id =&gt; todos[id].done()
  }
}
</code></pre>
<ol>
<li>
<p><code>arrow function</code> vs <code>function</code></p>
<ol>
<li>IE11を意識した場合、変換したら結局 <code>function</code> となる</li>
<li>読みやすさと生成された後のコードを妄想しつつ相談</li>
<li>つい書きやすさと <code>return</code> の省略したさで <code>arrow function</code> を使うことも多い</li>
<li>読みやすければそれでいい気持ちになってきている</li>
</ol>
</li>
<li>
<p><code>class</code> syntaxを避ける</p>
<ol>
<li>ライブラリを開発しているときには使うけれどプロダクトを書く時には意識する</li>
<li>結局 <code>this</code> に状態を持たせる意味がそのclassにあるかが大事</li>
<li>ファイルサイズがデカくなる</li>
</ol>
</li>
</ol>
<pre><code class="language-js">var touch = &#x27;touch&#x27;
$(&#x27;#id&#x27;).on(`${touch}start ${touch}end`, e =&gt; {
  console.log(e)
})

function a (element) {
  // var element と書く３文字を省略して１文字にできる
  element = document.getElementById(&#x27;foo&#x27;)
  element.addEventListener(&#x27;click&#x27;, e =&gt; console.log(e))
}
</code></pre>
<ol>
<li>
<p>長い文字列は変数で受けて結合する</p>
<ol>
<li>小さいことを売りにしているライブラリで見る</li>
<li>計算量も大事だが地道なファイルサイズ対策</li>
</ol>
</li>
<li>
<p>無駄な引数を定義する</p>
<ol>
<li>変数定義分の文字列を節約させる</li>
<li>htmlのタグなどを書く際に利用されている場合がある</li>
<li>linterで積極的に使うなと怒られる（怒られる方が平和）</li>
</ol>
</li>
</ol>
<h2>まとめ</h2>
<p>圧倒的老害感。</p>
<p><img src="http://4.bp.blogspot.com/-foiW8aYeL6s/VzZu-o6sxnI/AAAAAAAA6oQ/LHXzT0WsAX8LtB_U-msHk572kC_rY3VawCLcB/s800/mental_health_man.png" alt="image"/></p></div></div></div></section></div></div></div><div id="__next-error"></div></div><div><script>
          __NEXT_DATA__ = {"props":{"post":{"data":{"title":"Frontend JavaScript Anti-pattern","date":"2017-10-31T14:00:00.000Z","permalink":"/entry/2017/10/31/frontend-javascript-anti-pattern/","page":"post","_entry":"posts/2017-10-31-frontend-js-anti-pattern/index.md","name":"index","category":"2017-10-31-frontend-js-anti-pattern","url":"/entry/2017/10/31/frontend-javascript-anti-pattern/"},"content":"# TL;DR\n\n- 自分のエゴで書いてる手癖や無駄な努力をコードレビューするのは非生産的\n- 積極的にlinterを採用\n\n## test\n\n```js\nimport assert from 'assert'\n\ndescribe('test', () =\u003e {\n  const { func } = require('./module')\n  it('func', () =\u003e {\n    assert(func('a') === 'a')\n  })\n})\n```\n\n1. 1ファイル、single `describe`\n    1. 親を1つ `describe.skip` `describe.only` できれば一旦闇を保留にできることが多い\n    1. 1ファイルの持っている役割が大きすぎない、特に困っていない\n1. テスト対象は `describe` の中でrequireする\n    1. `describe.only` 実行をした際に不要なsrcを読み込まなくて良い\n    1. 読み込まれただけで実行される関数はcoverageに含まれてしまう\n    1. `coverage report` が読みやすい\n1. `this` を使わない\n    1. unused変数をlintで発見しやすい\n    1. 長い\n\n## src\n\n```js\nfunction mapStateToProps ({ todos }: State) {\n  return {\n    tasks: { todos },\n    onUpdate: id =\u003e todos[id].done()\n  }\n}\n```\n\n1. `arrow function` vs `function`\n    1. IE11を意識した場合、変換したら結局 `function` となる\n    1. 読みやすさと生成された後のコードを妄想しつつ相談\n    1. つい書きやすさと `return` の省略したさで `arrow function` を使うことも多い\n    1. 読みやすければそれでいい気持ちになってきている\n1. `class` syntaxを避ける\n    1. ライブラリを開発しているときには使うけれどプロダクトを書く時には意識する\n    1. 結局 `this` に状態を持たせる意味がそのclassにあるかが大事\n    1. ファイルサイズがデカくなる\n\n```js\nvar touch = 'touch'\n$('#id').on(`${touch}start ${touch}end`, e =\u003e {\n  console.log(e)\n})\n\nfunction a (element) {\n  // var element と書く３文字を省略して１文字にできる\n  element = document.getElementById('foo')\n  element.addEventListener('click', e =\u003e console.log(e))\n}\n```\n\n1. 長い文字列は変数で受けて結合する\n    1. 小さいことを売りにしているライブラリで見る\n    1. 計算量も大事だが地道なファイルサイズ対策\n1. 無駄な引数を定義する\n    1. 変数定義分の文字列を節約させる\n    1. htmlのタグなどを書く際に利用されている場合がある\n    1. linterで積極的に使うなと怒られる（怒られる方が平和）\n\n## まとめ\n\n圧倒的老害感。\n\n![image](http://4.bp.blogspot.com/-foiW8aYeL6s/VzZu-o6sxnI/AAAAAAAA6oQ/LHXzT0WsAX8LtB_U-msHk572kC_rY3VawCLcB/s800/mental_health_man.png)\n"}},"pathname":"/post","query":{"_entry":"posts/2017-10-31-frontend-js-anti-pattern/index.md"},"buildId":"6f6265f8-680a-44ae-af1a-c769f88afddc","buildStats":{"app.js":{"hash":"39a698509300633fdb6653901559ccd2"}},"assetPrefix":"","nextExport":true,"err":null,"chunks":[]}
          module={}
          __NEXT_LOADED_PAGES__ = []
          __NEXT_LOADED_CHUNKS__ = []

          __NEXT_REGISTER_PAGE = function (route, fn) {
            __NEXT_LOADED_PAGES__.push({ route: route, fn: fn })
          }

          __NEXT_REGISTER_CHUNK = function (chunkName, fn) {
            __NEXT_LOADED_CHUNKS__.push({ chunkName: chunkName, fn: fn })
          }
        </script><script async="" id="__NEXT_PAGE__/post" type="text/javascript" src="/_next/6f6265f8-680a-44ae-af1a-c769f88afddc/page/post.js"></script><script async="" id="__NEXT_PAGE__/_error" type="text/javascript" src="/_next/6f6265f8-680a-44ae-af1a-c769f88afddc/page/_error.js"></script><div></div><script type="text/javascript" src="/_next/39a698509300633fdb6653901559ccd2/app.js" async=""></script></div></body></html>