{"data":{"date":"2016-08-20T05:28:25.000Z","permalink":"/entry/2016/08/20/typescript-coverage/","title":"TypeScript で coverage を計測する","category":"js","_entry":"posts/ts/2016-08-20-typescript-coverage.md","page":"post","name":"typescript-coverage","url":"/entry/2016/08/20/typescript-coverage/"},"content":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"TypeScriptでCoverage reportを計測する","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":34,"offset":34}}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":34,"offset":34}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"TL;DR","position":{"start":{"line":4,"column":4,"offset":39},"end":{"line":4,"column":9,"offset":44}}}],"position":{"start":{"line":4,"column":1,"offset":36},"end":{"line":4,"column":9,"offset":44}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.npmjs.com/package/remap-istanbul"},"children":[{"type":"text","value":"remap-istanbul","position":{"start":{"line":6,"column":4,"offset":49},"end":{"line":6,"column":18,"offset":63}}}],"position":{"start":{"line":6,"column":3,"offset":48},"end":{"line":6,"column":65,"offset":110}}},{"type":"text","value":" を使う","position":{"start":{"line":6,"column":65,"offset":110},"end":{"line":6,"column":69,"offset":114}}}],"position":{"start":{"line":6,"column":1,"offset":46},"end":{"line":6,"column":69,"offset":114}}},{"type":"text","value":"\n"}],"position":{"start":{"line":6,"column":1,"offset":46},"end":{"line":6,"column":69,"offset":114}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Usage","position":{"start":{"line":8,"column":4,"offset":119},"end":{"line":8,"column":9,"offset":124}}}],"position":{"start":{"line":8,"column":1,"offset":116},"end":{"line":8,"column":9,"offset":124}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"npm install remap-istanbul"}],"position":{"start":{"line":10,"column":3,"offset":128},"end":{"line":10,"column":31,"offset":156}}}],"position":{"start":{"line":10,"column":1,"offset":126},"end":{"line":10,"column":31,"offset":156}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"sourcemap: true"}],"position":{"start":{"line":11,"column":3,"offset":159},"end":{"line":11,"column":20,"offset":176}}}],"position":{"start":{"line":11,"column":1,"offset":157},"end":{"line":11,"column":20,"offset":176}}},{"type":"text","value":"\n"}],"position":{"start":{"line":10,"column":1,"offset":126},"end":{"line":11,"column":20,"offset":176}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Memo","position":{"start":{"line":13,"column":4,"offset":181},"end":{"line":13,"column":8,"offset":185}}}],"position":{"start":{"line":13,"column":1,"offset":178},"end":{"line":13,"column":8,"offset":185}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"tsc"}],"position":{"start":{"line":15,"column":3,"offset":189},"end":{"line":15,"column":8,"offset":194}}},{"type":"text","value":" > ","position":{"start":{"line":15,"column":8,"offset":194},"end":{"line":15,"column":11,"offset":197}}},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"npm test"}],"position":{"start":{"line":15,"column":11,"offset":197},"end":{"line":15,"column":21,"offset":207}}},{"type":"text","value":" という流れになったためJavaScriptとしてテストをする形になる","position":{"start":{"line":15,"column":21,"offset":207},"end":{"line":15,"column":56,"offset":242}}}],"position":{"start":{"line":15,"column":1,"offset":187},"end":{"line":15,"column":56,"offset":242}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.npmjs.com/package/espower-typescript"},"children":[{"type":"text","value":"espower-typescript","position":{"start":{"line":16,"column":4,"offset":246},"end":{"line":16,"column":22,"offset":264}}}],"position":{"start":{"line":16,"column":3,"offset":245},"end":{"line":16,"column":73,"offset":315}}},{"type":"text","value":" を使わないようになる","position":{"start":{"line":16,"column":73,"offset":315},"end":{"line":16,"column":84,"offset":326}}},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"espower-typescript"}],"position":{"start":{"line":17,"column":5,"offset":331},"end":{"line":17,"column":25,"offset":351}}},{"type":"text","value":" はtscのwrapperなのでtscする場合は使えなそう","position":{"start":{"line":17,"column":25,"offset":351},"end":{"line":17,"column":54,"offset":380}}}],"position":{"start":{"line":17,"column":3,"offset":329},"end":{"line":17,"column":54,"offset":380}}},{"type":"text","value":"\n"}],"position":{"start":{"line":17,"column":3,"offset":329},"end":{"line":17,"column":54,"offset":380}}}],"position":{"start":{"line":16,"column":1,"offset":243},"end":{"line":17,"column":54,"offset":380}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"power-assert"}],"position":{"start":{"line":18,"column":3,"offset":383},"end":{"line":18,"column":17,"offset":397}}},{"type":"text","value":" が上手く構造を解釈してくれてなさそう","position":{"start":{"line":18,"column":17,"offset":397},"end":{"line":18,"column":36,"offset":416}}},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"espower-typescript"}],"position":{"start":{"line":19,"column":5,"offset":421},"end":{"line":19,"column":25,"offset":441}}},{"type":"text","value":" が担っていた役割を別で与える必要がある","position":{"start":{"line":19,"column":25,"offset":441},"end":{"line":19,"column":45,"offset":461}}}],"position":{"start":{"line":19,"column":3,"offset":419},"end":{"line":19,"column":45,"offset":461}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"TypeScriptに依存するなら無駄にbabel pluginなどは使いたくない","position":{"start":{"line":20,"column":5,"offset":466},"end":{"line":20,"column":46,"offset":507}}},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"TODO考える","position":{"start":{"line":21,"column":7,"offset":514},"end":{"line":21,"column":14,"offset":521}}}],"position":{"start":{"line":21,"column":5,"offset":512},"end":{"line":21,"column":14,"offset":521}}},{"type":"text","value":"\n"}],"position":{"start":{"line":21,"column":5,"offset":512},"end":{"line":21,"column":14,"offset":521}}}],"position":{"start":{"line":20,"column":3,"offset":464},"end":{"line":21,"column":14,"offset":521}}},{"type":"text","value":"\n"}],"position":{"start":{"line":19,"column":3,"offset":419},"end":{"line":21,"column":14,"offset":521}}}],"position":{"start":{"line":18,"column":1,"offset":381},"end":{"line":21,"column":14,"offset":521}}},{"type":"text","value":"\n"}],"position":{"start":{"line":15,"column":1,"offset":187},"end":{"line":21,"column":14,"offset":521}}},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Refs","position":{"start":{"line":23,"column":4,"offset":526},"end":{"line":23,"column":8,"offset":530}}}],"position":{"start":{"line":23,"column":1,"offset":523},"end":{"line":23,"column":8,"offset":530}}},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"http://blog.syati.info/post/typescript_coverage/"},"children":[{"type":"text","value":"http://blog.syati.info/post/typescript_coverage/","position":{"start":{"line":25,"column":4,"offset":535},"end":{"line":25,"column":52,"offset":583}}}],"position":{"start":{"line":25,"column":3,"offset":534},"end":{"line":25,"column":53,"offset":584}}}],"position":{"start":{"line":25,"column":1,"offset":532},"end":{"line":25,"column":53,"offset":584}}},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/9renpoto/ts/pull/34"},"children":[{"type":"text","value":"https://github.com/9renpoto/ts/pull/34","position":{"start":{"line":26,"column":4,"offset":588},"end":{"line":26,"column":42,"offset":626}}}],"position":{"start":{"line":26,"column":3,"offset":587},"end":{"line":26,"column":43,"offset":627}}}],"position":{"start":{"line":26,"column":1,"offset":585},"end":{"line":26,"column":43,"offset":627}}},{"type":"text","value":"\n"}],"position":{"start":{"line":25,"column":1,"offset":532},"end":{"line":26,"column":43,"offset":627}}}],"data":{"quirksMode":false},"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":1,"offset":0}}},"raw":"\n# TypeScriptでCoverage reportを計測する\n\n## TL;DR\n\n- [remap-istanbul](https://www.npmjs.com/package/remap-istanbul) を使う\n\n## Usage\n\n- `npm install remap-istanbul`\n- `sourcemap: true`\n\n## Memo\n\n- `tsc` > `npm test` という流れになったためJavaScriptとしてテストをする形になる\n- [espower-typescript](https://www.npmjs.com/package/espower-typescript) を使わないようになる\n  - `espower-typescript` はtscのwrapperなのでtscする場合は使えなそう\n- `power-assert` が上手く構造を解釈してくれてなさそう\n  - `espower-typescript` が担っていた役割を別で与える必要がある\n  - TypeScriptに依存するなら無駄にbabel pluginなどは使いたくない\n    - TODO考える\n\n## Refs\n\n- <http://blog.syati.info/post/typescript_coverage/>\n- <https://github.com/9renpoto/ts/pull/34>\n"}